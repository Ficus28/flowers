<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–∫–∞–∑–∞ | Flowers</title>
  <link rel="stylesheet" href="bootstrap.min.css">
</head>
<body class="bg-light p-5">

  <div class="container">
    <h2 class="mb-4 text-center">üîé –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞</h2>

    <!-- –§–æ—Ä–º–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ -->
    <form id="statusForm" class="row g-3 mb-5">
      <div class="col-md-8">
        <input type="email" name="email" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à—É –ø–æ—á—Ç—É" required>
      </div>
      <div class="col-md-4">
        <button type="submit" class="btn btn-success w-100">–£–∑–Ω–∞—Ç—å —Å—Ç–∞—Ç—É—Å</button>
      </div>
    </form>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∏—Å–∫–∞ -->
    <div id="result" class="card d-none shadow-sm">
      <div class="card-body">
        <h5 class="card-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑–µ</h5>
        <p><strong>–§–ò–û:</strong> <span id="resName"></span></p>
        <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> <span id="resPhone"></span></p>
        <p><strong>–¶–≤–µ—Ç—ã:</strong> <span id="resFlowers"></span></p>
        <p><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</strong> <span id="resQuantity"></span></p>
        <p><strong>–î–∞—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> <span id="resDate"></span></p>
        <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="resStatus" class="badge bg-info text-dark"></span></p>
      </div>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ -->
    <div id="notFound" class="alert alert-warning d-none mt-4" role="alert">
      –ó–∞–∫–∞–∑ —Å —Ç–∞–∫–æ–π –ø–æ—á—Ç–æ–π –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.
    </div>
  </div>

  <script>
    document.getElementById('statusForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      document.getElementById('result').classList.add('d-none');
      document.getElementById('notFound').classList.add('d-none');

      const email = this.email.value.trim();

      const res = await fetch('/api/order-status?email=' + encodeURIComponent(email));
      const data = await res.json();

      if (data && data.client_name) {
        document.getElementById('resName').textContent = data.client_name;
        document.getElementById('resPhone').textContent = data.phone_number;
        document.getElementById('resFlowers').textContent = data.flower_type;
        document.getElementById('resQuantity').textContent = data.quantity;
        document.getElementById('resDate').textContent = data.delivery_date;
        document.getElementById('resStatus').textContent = data.status;

        document.getElementById('result').classList.remove('d-none');
      } else {
        document.getElementById('notFound').classList.remove('d-none');
      }
    });
  </script>

</body>
</html>
